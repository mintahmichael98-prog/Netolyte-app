import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import React, { useState, useEffect } from 'react';
import { X, Plug, User, Save, Globe, SlidersHorizontal, Chrome, Languages, Cloud } from 'lucide-react';
import toast from 'react-hot-toast';
import ExtensionBridge from './ExtensionBridge';
export default function SettingsModal({ isOpen, onClose, settings, onSave, onAddLeads }) {
    const [localSettings, setLocalSettings] = useState(settings);
    const [activeTab, setActiveTab] = useState('general');
    useEffect(() => {
        setLocalSettings(settings);
        setActiveTab('general'); // Reset to general tab on open
    }, [settings, isOpen]);
    if (!isOpen)
        return null;
    const handleSave = () => {
        onSave(localSettings);
        onClose();
        toast.success("Settings saved successfully");
    };
    const handleSalesforceConnect = () => {
        // Simulate OAuth flow
        toast.loading("Connecting to Salesforce...");
        setTimeout(() => {
            toast.dismiss();
            setLocalSettings(prev => ({
                ...prev,
                salesforce: {
                    ...prev.salesforce,
                    connected: true,
                    instanceUrl: 'https://na1.salesforce.com'
                }
            }));
            toast.success("Salesforce Connected!");
        }, 2000);
    };
    const handleSalesforceDisconnect = () => {
        setLocalSettings(prev => ({
            ...prev,
            salesforce: { ...prev.salesforce, connected: false }
        }));
        toast.success("Salesforce Disconnected");
    };
    const TabButton = ({ isActive, onClick, icon: Icon, label }) => (_jsxs("button", { onClick: onClick, className: `flex items-center gap-2 px-4 py-3 text-sm font-bold border-b-2 transition-colors ${isActive
            ? 'border-indigo-600 text-indigo-600 dark:text-indigo-400'
            : 'border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300'}`, children: [_jsx(Icon, { className: "w-4 h-4" }), " ", label] }));
    return (_jsx("div", { className: "fixed inset-0 bg-slate-900/80 backdrop-blur-sm flex items-center justify-center z-[90] p-4", children: _jsxs("div", { className: "bg-white dark:bg-slate-800 rounded-xl max-w-2xl w-full shadow-2xl border border-slate-200 dark:border-slate-700 flex flex-col max-h-[90vh]", children: [_jsxs("div", { className: "flex justify-between items-center p-6 border-b border-slate-200 dark:border-slate-700", children: [_jsx("h2", { className: "text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2", children: "Settings & Configuration" }), _jsx("button", { onClick: onClose, className: "text-slate-500 hover:text-slate-700 dark:hover:text-slate-300", children: _jsx(X, { className: "w-5 h-5" }) })] }), _jsxs("div", { className: "flex border-b border-slate-200 dark:border-slate-700 px-4", children: [_jsx(TabButton, { isActive: activeTab === 'general', onClick: () => setActiveTab('general'), icon: SlidersHorizontal, label: "General" }), _jsx(TabButton, { isActive: activeTab === 'salesforce', onClick: () => setActiveTab('salesforce'), icon: Cloud, label: "Salesforce" }), _jsx(TabButton, { isActive: activeTab === 'integrations', onClick: () => setActiveTab('integrations'), icon: Chrome, label: "Extensions" })] }), _jsxs("div", { className: "p-6 overflow-y-auto space-y-8 bg-slate-50 dark:bg-slate-900/30 flex-1", children: [activeTab === 'general' && (_jsxs(_Fragment, { children: [_jsxs("section", { children: [_jsxs("h3", { className: "text-lg font-semibold text-slate-900 dark:text-white flex items-center gap-2 mb-4", children: [_jsx(Languages, { className: "w-5 h-5 text-indigo-600" }), " Language"] }), _jsxs("div", { className: "bg-white dark:bg-slate-800 p-5 rounded-xl border border-slate-200 dark:border-slate-700", children: [_jsx("label", { className: "block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2", children: "Interface Language" }), _jsxs("div", { className: "relative", children: [_jsx(Globe, { className: "absolute left-3 top-2.5 w-4 h-4 text-slate-400" }), _jsxs("select", { value: localSettings.language, onChange: (e) => setLocalSettings(s => ({ ...s, language: e.target.value })), className: "w-full pl-10 pr-4 py-2 rounded-lg bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 focus:ring-2 focus:ring-indigo-500 outline-none text-sm dark:text-white appearance-none cursor-pointer", children: [_jsx("option", { value: "en", children: "English (US)" }), _jsx("option", { value: "es", children: "Espa\u00F1ol" }), _jsx("option", { value: "fr", children: "Fran\u00E7ais" }), _jsx("option", { value: "de", children: "Deutsch" })] })] }), _jsx("p", { className: "text-xs text-slate-500 mt-2", children: "Adjust the dashboard interface language. Content generated by AI will still primarily match your search queries." })] })] }), _jsxs("section", { children: [_jsxs("h3", { className: "text-lg font-semibold text-slate-900 dark:text-white flex items-center gap-2 mb-4", children: [_jsx(Plug, { className: "w-5 h-5 text-indigo-600" }), " Webhooks"] }), _jsxs("div", { className: "bg-white dark:bg-slate-800 p-5 rounded-xl border border-slate-200 dark:border-slate-700", children: [_jsx("label", { className: "block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2", children: "Webhook URL" }), _jsx("div", { className: "flex gap-2", children: _jsx("input", { type: "text", value: localSettings.webhookUrl, onChange: (e) => setLocalSettings(s => ({ ...s, webhookUrl: e.target.value })), placeholder: "https://hooks.zapier.com/hooks/catch/...", className: "flex-1 px-4 py-2 rounded-lg bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 focus:ring-2 focus:ring-indigo-500 outline-none text-sm dark:text-white" }) }), _jsx("p", { className: "text-xs text-slate-500 mt-2", children: "We will send a JSON POST request to this URL whenever a lead's status is updated in the pipeline." })] })] }), _jsxs("section", { children: [_jsxs("h3", { className: "text-lg font-semibold text-slate-900 dark:text-white flex items-center gap-2 mb-4", children: [_jsx(User, { className: "w-5 h-5 text-indigo-600" }), " Brand Persona"] }), _jsxs("div", { className: "bg-white dark:bg-slate-800 p-5 rounded-xl border border-slate-200 dark:border-slate-700", children: [_jsx("label", { className: "block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2", children: "Global Tone & Voice" }), _jsx("textarea", { value: localSettings.brandVoice, onChange: (e) => setLocalSettings(s => ({ ...s, brandVoice: e.target.value })), placeholder: "e.g. Professional, authoritative, and concise. Use industry jargon but keep it friendly.", className: "w-full h-24 px-4 py-2 rounded-lg bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 focus:ring-2 focus:ring-indigo-500 outline-none text-sm resize-none dark:text-white" }), _jsx("p", { className: "text-xs text-slate-500 mt-2", children: "This persona will be instructed to the AI when generating Emails, SMS, and WhatsApp drafts." })] })] })] })), activeTab === 'salesforce' && (_jsxs("section", { className: "space-y-6", children: [_jsxs("div", { className: "bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-900 flex items-start gap-3", children: [_jsx(Cloud, { className: "w-6 h-6 text-blue-600 dark:text-blue-400 mt-1" }), _jsxs("div", { children: [_jsx("h4", { className: "font-bold text-blue-900 dark:text-blue-200", children: "Salesforce Integration" }), _jsx("p", { className: "text-sm text-blue-700 dark:text-blue-300 mt-1", children: "Sync generated leads directly to your Salesforce CRM as Leads or Contacts." })] })] }), _jsx("div", { className: "bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700", children: localSettings.salesforce?.connected ? (_jsxs("div", { className: "text-center py-6", children: [_jsx("div", { className: "w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4", children: _jsx(Plug, { className: "w-8 h-8 text-green-600 dark:text-green-400" }) }), _jsx("h3", { className: "text-lg font-bold text-slate-900 dark:text-white", children: "Connected to Salesforce" }), _jsxs("p", { className: "text-slate-500 text-sm mb-6", children: ["Org: ", localSettings.salesforce.instanceUrl] }), _jsxs("div", { className: "flex flex-col gap-3 max-w-xs mx-auto", children: [_jsxs("label", { className: "flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-900 rounded-lg cursor-pointer", children: [_jsx("input", { type: "checkbox", checked: localSettings.salesforce.autoSync, onChange: e => setLocalSettings(prev => ({ ...prev, salesforce: { ...prev.salesforce, autoSync: e.target.checked } })), className: "w-5 h-5 rounded text-blue-600" }), _jsx("span", { className: "text-sm font-medium text-slate-700 dark:text-slate-300", children: "Auto-sync new leads" })] }), _jsx("button", { onClick: handleSalesforceDisconnect, className: "px-4 py-2 border border-red-200 text-red-600 rounded-lg hover:bg-red-50 text-sm font-medium", children: "Disconnect" })] })] })) : (_jsxs("div", { className: "space-y-4", children: [_jsxs("div", { children: [_jsx("label", { className: "block text-xs font-bold text-slate-500 uppercase mb-1", children: "Consumer Key (Client ID)" }), _jsx("input", { type: "text", value: localSettings.salesforce?.clientId || '', onChange: e => setLocalSettings(prev => ({ ...prev, salesforce: { ...prev.salesforce, clientId: e.target.value } })), className: "w-full p-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-600 rounded-lg outline-none focus:ring-2 focus:ring-blue-500 dark:text-white", placeholder: "3MVG9..." })] }), _jsx("button", { onClick: handleSalesforceConnect, disabled: !localSettings.salesforce?.clientId, className: "w-full py-3 bg-[#00A1E0] hover:bg-[#0081B3] disabled:opacity-50 text-white font-bold rounded-xl shadow-lg transition-colors flex items-center justify-center gap-2", children: "Connect via OAuth" }), _jsx("p", { className: "text-xs text-center text-slate-400", children: "You will be redirected to login.salesforce.com to authorize." })] })) }), _jsxs("div", { className: "bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700", children: [_jsx("h4", { className: "font-bold text-slate-900 dark:text-white mb-4 text-sm", children: "Field Mapping" }), _jsxs("div", { className: "space-y-2 text-sm", children: [_jsxs("div", { className: "flex justify-between items-center p-2 bg-slate-50 dark:bg-slate-900 rounded", children: [_jsx("span", { className: "text-slate-500", children: "Netolyte Field" }), _jsx("span", { className: "text-slate-500", children: "Salesforce Object" })] }), _jsxs("div", { className: "flex justify-between items-center p-2 border-b border-slate-100 dark:border-slate-700", children: [_jsx("span", { className: "font-mono text-slate-700 dark:text-slate-300", children: "Company" }), _jsx("span", { className: "font-mono text-blue-600", children: "Lead.Company" })] }), _jsxs("div", { className: "flex justify-between items-center p-2 border-b border-slate-100 dark:border-slate-700", children: [_jsx("span", { className: "font-mono text-slate-700 dark:text-slate-300", children: "Contact Name" }), _jsx("span", { className: "font-mono text-blue-600", children: "Lead.Name" })] }), _jsxs("div", { className: "flex justify-between items-center p-2 border-b border-slate-100 dark:border-slate-700", children: [_jsx("span", { className: "font-mono text-slate-700 dark:text-slate-300", children: "Email" }), _jsx("span", { className: "font-mono text-blue-600", children: "Lead.Email" })] }), _jsxs("div", { className: "flex justify-between items-center p-2", children: [_jsx("span", { className: "font-mono text-slate-700 dark:text-slate-300", children: "Description" }), _jsx("span", { className: "font-mono text-blue-600", children: "Lead.Description" })] })] })] })] })), activeTab === 'integrations' && (_jsx(ExtensionBridge, { onAddLeads: onAddLeads }))] }), _jsxs("div", { className: "p-6 border-t border-slate-200 dark:border-slate-700 flex justify-end gap-3 bg-white dark:bg-slate-800 rounded-b-xl", children: [_jsx("button", { onClick: onClose, className: "px-4 py-2 text-slate-600 dark:text-slate-300 font-medium hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg", children: "Cancel" }), _jsxs("button", { onClick: handleSave, className: "px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium flex items-center gap-2 shadow-sm", children: [_jsx(Save, { className: "w-4 h-4" }), " Save Changes"] })] })] }) }));
}
